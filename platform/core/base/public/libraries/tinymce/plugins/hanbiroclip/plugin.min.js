!function(n){window.ngElement=$;window.isIE=function(){return false;};window.loadJS=function(e){var t,n=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1],o=arguments[2],r=window,c=r.document.getElementsByTagName("script")[0],a=r.document.createElement("script"),r=void 0;return"string"==typeof e?r=e:(r=e.src,e.type&&(a.type=e.type)),r+="?v=123",document.querySelector('[src="'+r+'"]')?n():("boolean"==typeof n&&(t=o,o=n,n=t),a.src=r,a.async=!o,c.parentNode.insertBefore(a,c),n&&"function"==typeof n&&(a.onload=n),a)};var r={};function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=n,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e){function r(t){var e,n,r=t.margin?"margin":!!t.MARGIN&&"MARGIN";if(r){for(e in n=u.style.parse.margin(t[r]))t["margin-"+e]=n[e];delete t[r]}}var n,u={convertHexStringToBytes:function(t){for(var e=[],n=t.length/2,r=0;r<n;r++)e.push(parseInt(t.substr(2*r,2),16));return e},convertBytesToBase64:function(t){for(var e="",n=t.length,r=0;r<n;r+=3){var i,o=t.slice(r,r+3),a=o.length,s=[];if(a<3)for(i=a;i<3;i++)o[i]=0;for(s[0]=(252&o[0])>>2,s[1]=(3&o[0])<<4|o[1]>>4,s[2]=(15&o[1])<<2|(192&o[2])>>6,s[3]=63&o[2],i=0;i<4;i++)e+=i<=a?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s[i]):"="}return e},b64toBlobURL:function(t){return t=t.split(";base64,"),t=u.b64toBlob(t[1],t[0].replace("data:","")),URL.createObjectURL(t)},b64toBlob:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:512,r=atob(t),i=[],o=0;o<r.length;o+=n){for(var a=r.slice(o,o+n),s=new Array(a.length),l=0;l<a.length;l++)s[l]=a.charCodeAt(l);var c=new Uint8Array(s);i.push(c)}return new Blob(i,{type:e})},objectKeys:function(t){var e,n=[];for(e in t)n.push(e);return n},writeCssText:function(t,e){var n,r=[];for(n in t)r.push(n+":"+t[n]);return e&&r.sort(),r.join("; ")},indexOf:function(t,e){if("function"==typeof e){for(var n=0,r=t.length;n<r;n++)if(e(t[n]))return n}else{if(t.indexOf)return t.indexOf(e);for(n=0,r=t.length;n<r;n++)if(t[n]===e)return n}return-1},convertToPx:function(t,e){return n=n||$('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"></div>').appendTo(e.getBody()),/%$/.test(t)?t:((e=parseFloat(t)<0)&&(t=t.replace("-","")),n.css("width",t),t=n.clientWidth,e?-t:t)},normalizeHex:function(t){return t.replace(/#(([0-9a-f]{3}){1,2})($|;|\s+)/gi,function(t,e,n,r){var i=e.toLowerCase();return 3==i.length&&(i=[(e=i.split(""))[0],e[0],e[1],e[1],e[2],e[2]].join("")),"#"+i+r})},convertRgbToHex:function(t){return t.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,function(t,e,n,r){for(var i=[e,n,r],o=0;o<3;o++)i[o]=("0"+parseInt(i[o],10).toString(16)).slice(-2);return"#"+i.join("")})},parseCssText:function(t,r){var i={};return(t=t&&u.normalizeHex(u.convertRgbToHex(t)))&&";"!=t&&t.replace(/&quot;/g,'"').replace(/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(t,e,n){r&&("font-family"==(e=e.toLowerCase())&&(n=n.replace(/\s*,\s*/g,",")),n=$.trim(n)),i[e]=n}),i},normalizedStyles:function(t,e,n){function r(){for(var t=[],e=0;e<arguments.length;e++)arguments[e]&&t.push(arguments[e]);return-1!==u.indexOf(i,t.join(":"))}for(var i=["background-color:transparent","border-image:none","color:windowtext","direction:ltr","mso-","visibility:visible","div:border:none"],o=u.parseCssText(t.style),a=u.objectKeys(o),s=0;s<a.length;s++){var l=a[s].toLowerCase(),c=o[a[s]];u.indexOf,(r(null,l,c)||r(null,l.replace(/\-.*$/,"-"))||r(null,l)||r(e,l,c)||r(e,l.replace(/\-.*$/,"-"))||r(e,l)||r(c))&&delete o[a[s]]}return u.writeCssText(o)},getStyles:function(t){var e=document.createElement("iframe");return e.style.display="none",document.body.appendChild(e),t=t.replace(/src=(["']).*?\1/gi,""),e.contentWindow.document.open("text/htmlreplace"),e.contentWindow.document.write(t),e.contentWindow.document.close(),function(t){for(var e={},n=0;n<t.styleSheets.length;++n)for(var r=t.styleSheets[n],i=0;i<r.cssRules.length;++i){for(var o,a=r.cssRules[i],s=a.cssText.slice(a.cssText.indexOf("{")+1).split(";"),l={},c=0;c<s.length;++c){var u,f=s[c].split(":");2==f.length&&(u=f[0].trim(),f=f[1].trim(),l[u]=f)}for(o in l){e[a.selectorText]=l;break}}return e}(e.contentWindow.document)},word_filter:function(t){var e=$("<div />").append(t);t=(t=(t=(t=(t=t.replace(/<!--[\s\S]+?-->/gi,"")).replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,"")).replace(/<(\/?)s>/gi,"<$1strike>")).replace(/&nbsp;/gi," ")).replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(t,e){return 0<e.length?e.replace(/./," ").slice(Math.floor(e.length/2)).split("").join("Â "):""}),$("p",e).each(function(){var t=$(this).attr("style");(t=/mso-list:\w+ \w+([0-9]+)/.exec(t))&&$(this).data("_listLevel",parseInt(t[1],10))});var a=0,s=null,l='style="margin-bottom: 0cm; margin-top: 0px;"';return $("p",e).each(function(){var t=$(this).data("_listLevel"),e="",n="";if(null!=t){var r=$(this).text(),i="<ul "+l+"></ul>";if(/^\s*\w+\./.test(r)&&(i=(r=/([0-9])\./.exec(r))?1<(r=parseInt(r[1],10))?"<ol "+l+' start="'+r+'"></ol>':"<ol></ol>":"<ol "+l+"></ol>"),a<t&&(s=0==a?($(this).before(i),$(this).prev()):$(i).appendTo(s)),t<a)for(var o=0;o<a-t;o++)s=s.parent();$("span:first",this).remove(),this.className&&(e=['class="',this.className,'"'].join("")),$(this).attr("style")&&(n=['style="',$(this).attr("style"),'"'].join("")),s.append("<li "+n+" "+e+">"+$(this).html()+"</li>"),$(this).remove(),a=t}else a=0}),e.html()},clone:function(e,n){var r={};return e instanceof Array?e.map(function(t){return this.clone(t,n)}):e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e):e instanceof Function?n&&n.newFns?new Function("return "+e.toString())():e:e instanceof Object?(Object.keys(e).forEach(_.bind(function(t){r[t]=this.clone(e[t],n)},this)),r):-1<[void 0,null].indexOf(e)?e:"Symbol"===e.constructor.name?Symbol(e.toString().replace(/^Symbol\(/,"").slice(0,-1)):e.__proto__.constructor(e)},getStyleByClassName:function(t,e,n,r){function i(e,t){var n=Object.keys(t).toString();return Object.keys(e).map(function(t){-1!==n.indexOf(t)&&delete e[t]}),e}for(var o,a=Object.keys(t),s=(r=r||!1,0);s<a.length;s++)o=a[s],(e&&o.match(e)||n==o)&&(r=r?n==o?_.extend(r,i(t[o],r)):_.extend(i(r,t[o]),t[o]):t[o]);return r},cleanSpecialAtrributes:function(t){return t.replace(/xmlns="[^"]*"/gi,"")},style:{parse:{margin:function(t){var e={},n=t.match(/(?:\-?[\.\d]+(?:%|\w*)|auto|inherit|initial|unset)/g)||["0px"];switch(n.length){case 1:r([0,0,0,0]);break;case 2:r([0,1,0,1]);break;case 3:r([0,1,2,1]);break;case 4:r([0,1,2,3])}function r(t){e.top=n[t[0]],e.right=n[t[1]],e.bottom=n[t[2]],e.left=n[t[3]]}return e}}},keepSelfStyles:function(e,t){var n="";return r(e),t&&(r(t),t["text-indent"]&&t["margin-left"]&&(delete t["text-indent"],t["margin-left"]=0)),e=_.extend(e,t),Object.keys(e).map(function(t){n+=[t,e[t]+";"].join(":")}),n},isImageURL:function(t){return null!==t.match(/(https?:\/\/.*\.(?:png|jpg))$/i)}};t.exports=u},function(t,e,n){function r(t,e){_.assign(this,e),"undefined"==typeof sanitizeHtml&&this._getSanitizeHtml(),this.editor=t,this.html=null}var i=window.jQuery,o=tinymce,a=n(0),s=n(2),l=n(3);r.prototype={constructor:r,init:function(){var o=this.editor;isIE()?o.on("paste",_.bind(function(){setTimeout(_.bind(function(){this.resetContent()},this),100)},this)):o.on("paste",_.bind(function(t){var e,r=0;t.preventDefault(),t.clipboardData&&((e=t.clipboardData.types)instanceof DOMStringList&&(e=Array.from(e)),-1!==e.indexOf("Files")&&-1===e.indexOf("text/html")?l(t).then(function(t){o.insertContent('<img src="'+t+'" />')},function(){o.windowManager.alert("We're sorry. The file was copied doesn't support paste to this Editor.")}):(this.html=t.clipboardData.getData("text/html"),text=t.clipboardData.getData("text/plain"),""==this.html&&""!=text&&(this.html=text.replace(/(?:\r\n|\r|\n)/g,"<br>")),a.isImageURL(this.html)?o.insertContent('<img src="'+this.html+'" />'):s(t).then(_.bind(function(n){return""!=i.trim(this.html)&&"<table"==this.html.substr(0,6)?void o.insertContent(this.html):(this.html.match(/microsoft.com|CocoaVersion|LibreOffice|google-sheets-html/)?(this.html=a.word_filter(this.html),css=a.getStyles(a.clone(this.html)),this.html=sanitizeHtml(this.html,{allowedAttributes:!1,allowedSchemes:["http","https","ftp","mailto","blob","data"],allowedTags:["h1","h2","h3","h4","h5","h6","blockquote","p","a","ul","ol","img","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","colgroup","pre","iframe","span","font"],transformTags:{img:function(t,e){return n[r]&&(e.src=n[r],r++),{tagName:t,attribs:e}},"*":function(t,e){e.style?e.style=a.normalizedStyles(e,t,o):e.style="";var n=a.getStyleByClassName(a.clone(css),e.class,t,!1);return n&&(e.style=a.keepSelfStyles(n,a.parseCssText(e.style))),"br"==t&&(e.style+=";clear:both"),"table"==t&&-1!==e.style.indexOf("table-layout")&&(e.style=e.style.split(";").reduce(function(t,e){return-1===e.indexOf("table-layout")&&t.push(e),t},[]).join(";")),{tagName:t,attribs:e}}}})):this.html=a.cleanSpecialAtrributes(this.html),this.tableValidation(),this.replaceHrefToATags(),void this.editor.insertContent(this.html))},this))))},this)),o.on("dragover drop",_.bind(function(t){if((!o.selection.getNode()||"IMG"!==o.selection.getNode().nodeName)&&(t.stopPropagation(),t.preventDefault(),"drop"==t.type))for(var e=0;e<t.dataTransfer.files.length;e++){var n=t.dataTransfer.files[e];if(-1===n.type.indexOf("image"))return;var r,i=new FileReader;i.onload=function(t){r=a.b64toBlobURL(t.target.result);var e=document.createElement("img");t="",500<e.width&&(t='style="width:500px"'),o.insertContent("<img "+t+' src="'+r+'" />'),e.src=r},i.readAsDataURL(n)}},this))},resetContent:function(t){this.editor.contentDocument.body,t&&t.clipboardData?t.clipboardData:window.clipboardData&&window.clipboardData,this.editor;var e=this.editor;(t=e.getContent({type:"raw"})).match(/colgroup><span/gi)&&e.setContent(t),e.selection.collapse(!1)},_getSanitizeHtml:function(){loadJS([this.url,"js/sanitize-html.js"].join("/"))},replaceHrefToATags:function(){this.html=this.html.replace(/(="|blob:|">|>|url\(&quot;|&quot;|url\(\')?(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:\/~+#-]*[\w@?^=%&\/~+#-])?/gi,function(t,e){return e||t.match(/href=|blob:|">|&quot;|src=|=/)?t:'<a href="'+t+'">'+t+"</a>"})},tableValidation:function(){if(-1==this.html.indexOf("</table>"))return this.html;for(var t=(new DOMParser).parseFromString(this.html,"text/html"),e=t.getElementsByTagName("table"),n=0;n<e.length;n++){var r=e[n];r.style.tableLayout&&"fixed"==r.style.tableLayout&&(r.style.tableLayout=""),r.style.width&&"0px"==r.style.width&&(r.style.width="auto");var i=r.querySelectorAll("tr:first-child td");if(i.length&&i[0]&&i[0].hasAttribute("width"))for(var o=0;o<i.length;o++)i[o].style.width=null;var a=r.querySelectorAll("td");if(a.length)for(o=0;o<a.length;o++)a[o].hasAttribute("data-sheets-hyperlinkruns")&&a[o].removeAttribute("data-sheets-hyperlinkruns")}this.html=this.convertObjectToString(t)},convertObjectToString:function(t){for(var e=(new XMLSerializer).serializeToString(t),n=["</body></html>",'<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>',"</google-sheets-html-origin>","<google-sheets-html-origin>","/<style(.*)>(.*)</style>/g"],r=0;r<n;r++)e=e.replace(unuseTag[r],"");return e}},o.PluginManager.add("hanbiroclip",function(t,e){return console.log("...",t,e),new r(t,{url:e})})},function(t,e,n){var r=n(0);t.exports=function(c){var n=[];return new Promise(function(t){var s,l,e=function(t){var e,n=[],r="MicrosoftOffice"==(s="MicrosoftOffice",(l=c.clipboardData.getData("text/html"))&&-1!==l.indexOf("LibreOffice")&&(s="LibreOffice"),s)?/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/:/{\\pict\\(.*)\d\\?(.*)/,i=new RegExp("(?:("+r.source+"))([\\da-fA-F\\s]+)\\}","g"),o=t.match(i);if(!o)return n;for(var a=0;a<o.length;a++)if(r.test(o[a])){if(-1!==o[a].indexOf("\\pngblip"))e="image/png";else{if(-1===o[a].indexOf("\\jpegblip"))continue;e="image/jpeg"}n.push({hex:e?o[a].replace(r,"").replace(/[^\da-fA-F]/g,""):null,type:e})}return n}(c.clipboardData.getData("text/rtf"));e.length&&e.map(function(t){var e;n.push((e=t.type?"data:"+t.type+";base64,"+r.convertBytesToBase64(r.convertHexStringToBytes(t.hex)):null)?(t=e.split(";base64,"),e=r.b64toBlob(t[1],t[0].replace("data:","")),URL.createObjectURL(e)):e)}),t(n)})}},function(t,e,n){var s=n(0);t.exports=function(a){return new Promise(function(e,t){var n,r=(a.clipboardData||a.originalEvent.clipboardData).items;for(index in r)if("file"===(n=r[index]).kind)try{var i=n.getAsFile(),o=new FileReader;o.onload=function(t){e(s.b64toBlobURL(t.target.result))},o.readAsDataURL(i)}catch(n){t()}})}}]);